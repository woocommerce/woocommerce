(self.webpackChunk_woocommerce_block_library=self.webpackChunk_woocommerce_block_library||[]).push([[6293],{"./assets/js/base/components/cart-checkout/totals/coupon/stories/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,ErrorState:()=>ErrorState,LoadingState:()=>LoadingState,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var react=__webpack_require__("../../node_modules/.pnpm/react@18.3.1/node_modules/react/index.js"),external_STORYBOOK_MODULE_CLIENT_API_=__webpack_require__("@storybook/client-api"),custom_controls=__webpack_require__("./storybook/custom-controls/index.ts"),use_dispatch=__webpack_require__("../../node_modules/.pnpm/@wordpress+data@6.15.0_react@18.3.1/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),validation=__webpack_require__("./assets/js/data/validation/index.ts"),build_module=__webpack_require__("../../node_modules/.pnpm/@wordpress+i18n@4.45.0/node_modules/@wordpress/i18n/build-module/index.js"),components_button=__webpack_require__("./assets/js/base/components/button/index.tsx"),loading_mask=__webpack_require__("./assets/js/base/components/loading-mask/index.tsx"),with_instance_id=__webpack_require__("../../node_modules/.pnpm/@wordpress+compose@5.5.0_react@18.3.1/node_modules/@wordpress/compose/build-module/higher-order/with-instance-id/index.js"),components=__webpack_require__("./packages/components/index.ts"),use_select=__webpack_require__("../../node_modules/.pnpm/@wordpress+data@6.15.0_react@18.3.1/node_modules/@wordpress/data/build-module/components/use-select/index.js"),jsx_runtime=(__webpack_require__("./assets/js/base/components/cart-checkout/totals/coupon/style.scss"),__webpack_require__("../../node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-runtime.js"));const TotalsCoupon=({instanceId,isLoading=!1,onSubmit,displayCouponForm=!1})=>{const[couponValue,setCouponValue]=(0,react.useState)(""),[isCouponFormVisible,setIsCouponFormVisible]=(0,react.useState)(displayCouponForm),textInputId=`wc-block-components-totals-coupon__input-${instanceId}`,{validationErrorId}=(0,use_select.A)((select=>({validationErrorId:select(validation.O).getValidationErrorId(textInputId)}))),inputRef=(0,react.useRef)(null);return(0,jsx_runtime.jsx)(components.Zk,{className:"wc-block-components-totals-coupon",initialOpen:isCouponFormVisible,hasBorder:!1,title:(0,build_module.__)("Add a coupon","woocommerce"),state:[isCouponFormVisible,setIsCouponFormVisible],children:(0,jsx_runtime.jsx)(loading_mask.A,{screenReaderLabel:(0,build_module.__)("Applying coupon…","woocommerce"),isLoading,showSpinner:!1,children:(0,jsx_runtime.jsxs)("div",{className:"wc-block-components-totals-coupon__content",children:[(0,jsx_runtime.jsxs)("form",{className:"wc-block-components-totals-coupon__form",id:"wc-block-components-totals-coupon__form",children:[(0,jsx_runtime.jsx)(components.WL,{id:textInputId,errorId:"coupon",className:"wc-block-components-totals-coupon__input",label:(0,build_module.__)("Enter code","woocommerce"),value:couponValue,ariaDescribedBy:validationErrorId,onChange:newCouponValue=>{setCouponValue(newCouponValue)},focusOnMount:!0,validateOnMount:!1,showError:!1,ref:inputRef}),(0,jsx_runtime.jsx)(components_button.A,{className:"wc-block-components-totals-coupon__button",disabled:isLoading||!couponValue,showSpinner:isLoading,onClick:e=>{e.preventDefault(),void 0!==onSubmit?onSubmit(couponValue)?.then((result=>{result?(setCouponValue(""),setIsCouponFormVisible(!1)):inputRef.current?.focus&&inputRef.current.focus()})):(setCouponValue(""),setIsCouponFormVisible(!0))},type:"submit",children:(0,build_module.__)("Apply","woocommerce")})]}),(0,jsx_runtime.jsx)(components.aK,{propertyName:"coupon",elementId:textInputId})]})})})};TotalsCoupon.displayName="TotalsCoupon",TotalsCoupon.__docgenInfo={description:"",methods:[],displayName:"TotalsCoupon",props:{isLoading:{defaultValue:{value:"false",computed:!1},required:!1,tsType:{name:"boolean"},description:"Whether the component is in a loading state"},displayCouponForm:{defaultValue:{value:"false",computed:!1},required:!1,tsType:{name:"boolean"},description:"Whether the coupon form is hidden"},instanceId:{required:!0,tsType:{name:"string"},description:"Instance id of the input"},onSubmit:{required:!1,tsType:{name:"signature",type:"function",raw:"( couponValue: string ) => Promise< boolean > | undefined",signature:{arguments:[{name:"couponValue",type:{name:"string"}}],return:{name:"union",raw:"Promise< boolean > | undefined",elements:[{name:"Promise",elements:[{name:"boolean"}],raw:"Promise< boolean >"},{name:"undefined"}]}}},description:"Submit handler"}}};(0,with_instance_id.A)(TotalsCoupon);TotalsCoupon.__docgenInfo={description:"",methods:[],displayName:"TotalsCoupon",props:{instanceId:{required:!0,tsType:{name:"string"},description:"Instance id of the input"},isLoading:{required:!1,tsType:{name:"boolean"},description:"Whether the component is in a loading state",defaultValue:{value:"false",computed:!1}},displayCouponForm:{required:!1,tsType:{name:"boolean"},description:"Whether the coupon form is hidden",defaultValue:{value:"false",computed:!1}},onSubmit:{required:!1,tsType:{name:"signature",type:"function",raw:"( couponValue: string ) => Promise< boolean > | undefined",signature:{arguments:[{type:{name:"string"},name:"couponValue"}],return:{name:"union",raw:"Promise< boolean > | undefined",elements:[{name:"Promise",elements:[{name:"boolean"}],raw:"Promise< boolean >"},{name:"undefined"}]}}},description:"Submit handler"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["assets/js/base/components/cart-checkout/totals/coupon/index.tsx"]={name:"TotalsCoupon",docgenInfo:TotalsCoupon.__docgenInfo,path:"assets/js/base/components/cart-checkout/totals/coupon/index.tsx"});const index_stories={title:"Base Components/Totals/Coupon",component:TotalsCoupon,args:{initialOpen:!0}},INVALID_COUPON_ERROR={hidden:!1,message:"Invalid coupon code"},Template=args=>{const[{},setArgs]=(0,external_STORYBOOK_MODULE_CLIENT_API_.useArgs)();return(0,jsx_runtime.jsx)(TotalsCoupon,{...args,onSubmit:code=>(args.onSubmit?.(code),setArgs({isLoading:!0}),new Promise((resolve=>{setTimeout((()=>{setArgs({isLoading:!1}),resolve(!0)}),custom_controls.LG)})))})};Template.displayName="Template";const Default=Template.bind({});Default.args={};const LoadingState=Template.bind({});LoadingState.args={isLoading:!0};const ErrorState=args=>{const{setValidationErrors}=(0,use_dispatch.A)(validation.O);return setValidationErrors({coupon:INVALID_COUPON_ERROR}),(0,jsx_runtime.jsx)(TotalsCoupon,{...args})};ErrorState.displayName="ErrorState",ErrorState.decorators=[StoryComponent=>(0,jsx_runtime.jsx)(StoryComponent,{})],ErrorState.__docgenInfo={description:"",methods:[],displayName:"ErrorState"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["assets/js/base/components/cart-checkout/totals/coupon/stories/index.stories.tsx"]={name:"ErrorState",docgenInfo:ErrorState.__docgenInfo,path:"assets/js/base/components/cart-checkout/totals/coupon/stories/index.stories.tsx"}),Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => {\n  const [{}, setArgs] = useArgs();\n  const onSubmit = (code: string) => {\n    args.onSubmit?.(code);\n    setArgs({\n      isLoading: true\n    });\n    return new Promise(resolve => {\n      setTimeout(() => {\n        setArgs({\n          isLoading: false\n        });\n        resolve(true);\n      }, INTERACTION_TIMEOUT);\n    });\n  };\n  return <TotalsCoupon {...args} onSubmit={onSubmit} />;\n}",...Default.parameters?.docs?.source}}},LoadingState.parameters={...LoadingState.parameters,docs:{...LoadingState.parameters?.docs,source:{originalSource:"args => {\n  const [{}, setArgs] = useArgs();\n  const onSubmit = (code: string) => {\n    args.onSubmit?.(code);\n    setArgs({\n      isLoading: true\n    });\n    return new Promise(resolve => {\n      setTimeout(() => {\n        setArgs({\n          isLoading: false\n        });\n        resolve(true);\n      }, INTERACTION_TIMEOUT);\n    });\n  };\n  return <TotalsCoupon {...args} onSubmit={onSubmit} />;\n}",...LoadingState.parameters?.docs?.source}}},ErrorState.parameters={...ErrorState.parameters,docs:{...ErrorState.parameters?.docs,source:{originalSource:"args => {\n  const {\n    setValidationErrors\n  } = useDispatch(VALIDATION_STORE_KEY);\n  setValidationErrors({\n    coupon: INVALID_COUPON_ERROR\n  });\n  return <TotalsCoupon {...args} />;\n}",...ErrorState.parameters?.docs?.source}}};const __namedExportsOrder=["Default","LoadingState","ErrorState"]},"./assets/js/base/components/loading-mask/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("../../node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");var _wordpress_i18n__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/@wordpress+i18n@4.45.0/node_modules/@wordpress/i18n/build-module/index.js"),clsx__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),_woocommerce_blocks_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/components/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__("./assets/js/base/components/loading-mask/style.scss"),__webpack_require__("../../node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-runtime.js"));const LoadingMask=({children,className,screenReaderLabel,showSpinner=!1,isLoading=!0})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:(0,clsx__WEBPACK_IMPORTED_MODULE_5__.A)(className,{"wc-block-components-loading-mask":isLoading}),children:[isLoading&&showSpinner&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_woocommerce_blocks_components__WEBPACK_IMPORTED_MODULE_2__.y$,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:(0,clsx__WEBPACK_IMPORTED_MODULE_5__.A)({"wc-block-components-loading-mask__children":isLoading}),"aria-hidden":isLoading,children}),isLoading&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("span",{className:"screen-reader-text",children:screenReaderLabel||(0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_1__.__)("Loading…","woocommerce")})]});LoadingMask.displayName="LoadingMask",LoadingMask.__docgenInfo={description:"",methods:[],displayName:"LoadingMask",props:{showSpinner:{defaultValue:{value:"false",computed:!1},required:!1,tsType:{name:"boolean"},description:""},isLoading:{defaultValue:{value:"true",computed:!1},required:!1,tsType:{name:"boolean"},description:""},children:{required:!1,tsType:{name:"union",raw:"React.ReactNode | React.ReactNode[]",elements:[{name:"ReactReactNode",raw:"React.ReactNode"},{name:"Array",elements:[{name:"ReactReactNode",raw:"React.ReactNode"}],raw:"React.ReactNode[]"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},screenReaderLabel:{required:!1,tsType:{name:"string"},description:""}}};const __WEBPACK_DEFAULT_EXPORT__=LoadingMask;LoadingMask.__docgenInfo={description:"",methods:[],displayName:"LoadingMask",props:{children:{required:!1,tsType:{name:"union",raw:"React.ReactNode | React.ReactNode[]",elements:[{name:"ReactReactNode",raw:"React.ReactNode"},{name:"Array",elements:[{name:"ReactReactNode",raw:"React.ReactNode"}],raw:"React.ReactNode[]"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},screenReaderLabel:{required:!1,tsType:{name:"string"},description:""},showSpinner:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},isLoading:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["assets/js/base/components/loading-mask/index.tsx"]={name:"LoadingMask",docgenInfo:LoadingMask.__docgenInfo,path:"assets/js/base/components/loading-mask/index.tsx"})},"./storybook/custom-controls/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{LG:()=>INTERACTION_TIMEOUT});const INTERACTION_TIMEOUT=1500},"./assets/js/base/components/cart-checkout/totals/coupon/style.scss":()=>{},"./assets/js/base/components/loading-mask/style.scss":()=>{}}]);