jQuery(function(e){function n(){e(".woocommerce_variations .woocommerce_variation").each(function(t,n){e(".variation_menu_order",n).val(parseInt(e(n).index(".woocommerce_variations .woocommerce_variation"),10))})}var t={items:".woocommerce_variation",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:true,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style");n()}};e("#variable_product_options").on("click","button.add_variation",function(){e(".woocommerce_variations").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes_variations.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var t=e(".woocommerce_variation").size();var n={action:"woocommerce_add_variation",post_id:woocommerce_admin_meta_boxes_variations.post_id,loop:t,security:woocommerce_admin_meta_boxes_variations.add_variation_nonce};e.post(woocommerce_admin_meta_boxes_variations.ajax_url,n,function(t){e(".woocommerce_variations").append(t);e(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50});e("input.variable_is_downloadable, input.variable_is_virtual").change();e(".woocommerce_variations").unblock();e("#variable_product_options").trigger("woocommerce_variations_added")});return false});e("#variable_product_options").on("click","button.link_all_variations",function(){var t=window.confirm(woocommerce_admin_meta_boxes_variations.i18n_link_all_variations);if(t){e("#variable_product_options").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes_variations.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var n={action:"woocommerce_link_all_variations",post_id:woocommerce_admin_meta_boxes_variations.post_id,security:woocommerce_admin_meta_boxes_variations.link_variation_nonce};e.post(woocommerce_admin_meta_boxes_variations.ajax_url,n,function(t){var n=parseInt(t,10);if(1===n){window.alert(n+" "+woocommerce_admin_meta_boxes_variations.i18n_variation_added)}else if(0===n||n>1){window.alert(n+" "+woocommerce_admin_meta_boxes_variations.i18n_variations_added)}else{window.alert(woocommerce_admin_meta_boxes_variations.i18n_no_variations_added)}if(n>0){var r=window.location.toString();r=r.replace("post-new.php?","post.php?post="+woocommerce_admin_meta_boxes_variations.post_id+"&action=edit&");e("#variable_product_options").load(r+" #variable_product_options_inner",function(){e("#variable_product_options").unblock();e("#variable_product_options").trigger("woocommerce_variations_added");e(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50})})}else{e("#variable_product_options").unblock()}})}return false});e("#variable_product_options").on("click","button.remove_variation",function(t){t.preventDefault();var n=window.confirm(woocommerce_admin_meta_boxes_variations.i18n_remove_variation);if(n){var r=e(this).parent().parent();var i=e(this).attr("rel");if(i>0){e(r).block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes_variations.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var s={action:"woocommerce_remove_variation",variation_id:i,security:woocommerce_admin_meta_boxes_variations.delete_variation_nonce};e.post(woocommerce_admin_meta_boxes_variations.ajax_url,s,function(t){e(r).fadeOut("300",function(){e(r).remove()})})}else{e(r).fadeOut("300",function(){e(r).remove()})}}return false});e(".wc-metaboxes-wrapper").on("click","a.bulk_edit",function(t){var n=e("select#field_to_edit").val(),r,i,s;switch(n){case"toggle_enabled":r=e('input[name^="variable_enabled"]');r.attr("checked",!r.attr("checked"));break;case"toggle_downloadable":r=e('input[name^="variable_is_downloadable"]');r.attr("checked",!r.attr("checked"));e("input.variable_is_downloadable").change();break;case"toggle_virtual":r=e('input[name^="variable_is_virtual"]');r.attr("checked",!r.attr("checked"));e("input.variable_is_virtual").change();break;case"delete_all":i=window.confirm(woocommerce_admin_meta_boxes_variations.i18n_delete_all_variations);if(i){i=window.confirm(woocommerce_admin_meta_boxes_variations.i18n_last_warning);if(i){var o=[];e(".woocommerce_variations .woocommerce_variation").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes_variations.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});e(".woocommerce_variations .woocommerce_variation .remove_variation").each(function(){var t=e(this).attr("rel");if(t>0){o.push(t)}});var u={action:"woocommerce_remove_variations",variation_ids:o,security:woocommerce_admin_meta_boxes_variations.delete_variations_nonce};e.post(woocommerce_admin_meta_boxes_variations.ajax_url,u,function(t){e(".woocommerce_variations .woocommerce_variation").fadeOut("300",function(){e(".woocommerce_variations .woocommerce_variation").remove()})})}}break;case"variable_regular_price_increase":case"variable_regular_price_decrease":case"variable_sale_price_increase":case"variable_sale_price_decrease":var a;if(n.lastIndexOf("variable_regular_price",0)===0){a="variable_regular_price"}else{a="variable_sale_price"}s=window.prompt(woocommerce_admin_meta_boxes_variations.i18n_enter_a_value_fixed_or_percent).toString();e(':input[name^="'+a+'"]').each(function(){var t=Number(e(this).val()),r;if(s.indexOf("%")>=0){var i=Number(Number(t)/100*Number(s.replace(/\%/,"")))}else{var i=Number(s)}if(n.indexOf("increase")!==-1){r=t+i}else{r=t-i}e(this).val(r).change()});break;case"variable_regular_price":case"variable_sale_price":case"variable_stock":case"variable_weight":case"variable_length":case"variable_width":case"variable_height":case"variable_download_limit":case"variable_download_expiry":s=window.prompt(woocommerce_admin_meta_boxes_variations.i18n_enter_a_value);e(':input[name^="'+n+'["]').val(s).change();break;default:e("select#field_to_edit").trigger(n);break}});e("#variable_product_options").on("change","input.variable_is_downloadable",function(){e(this).closest(".woocommerce_variation").find(".show_if_variation_downloadable").hide();if(e(this).is(":checked")){e(this).closest(".woocommerce_variation").find(".show_if_variation_downloadable").show()}});e("#variable_product_options").on("change","input.variable_is_virtual",function(){e(this).closest(".woocommerce_variation").find(".hide_if_variation_virtual").show();if(e(this).is(":checked")){e(this).closest(".woocommerce_variation").find(".hide_if_variation_virtual").hide()}});e("input.variable_is_downloadable, input.variable_is_virtual").change();e("#variable_product_options").on("woocommerce_variations_added",function(){e(".woocommerce_variations").sortable(t)});e(".woocommerce_variations").sortable(t);var r;var i;var s;var o=wp.media.model.settings.post.id;e("#variable_product_options").on("click",".upload_image_button",function(t){var n=e(this);var u=n.attr("rel");var a=n.closest(".upload_image");s=a;i=u;t.preventDefault();if(n.is(".remove")){s.find(".upload_image_id").val("");s.find("img").attr("src",woocommerce_admin_meta_boxes_variations.woocommerce_placeholder_img_src);s.find(".upload_image_button").removeClass("remove")}else{if(r){r.uploader.uploader.param("post_id",i);r.open();return}else{wp.media.model.settings.post.id=i}r=wp.media.frames.variable_image=wp.media({title:woocommerce_admin_meta_boxes_variations.i18n_choose_image,button:{text:woocommerce_admin_meta_boxes_variations.i18n_set_image},states:[new wp.media.controller.Library({title:woocommerce_admin_meta_boxes_variations.i18n_choose_image,filterable:"all"})]});r.on("select",function(){var e=r.state().get("selection").first().toJSON();s.find(".upload_image_id").val(e.id);s.find(".upload_image_button").addClass("remove");s.find("img").attr("src",e.url);wp.media.model.settings.post.id=o});r.open()}});e("a.add_media").on(" click",function(){wp.media.model.settings.post.id=o})})